!function(e){"use strict";e.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)},e.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n)},e.onReady=function(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"complete"==document.readyState&&e()})},e.debounce=function(e,t){var n;return function(){var r=this,i=arguments;clearTimeout(n),n=setTimeout(function(){clearTimeout(n),e.apply(r,i)},t)}};function t(){(async function(e){return(await fetch(e)).text()})("/PostSearchData.json").then(function(t){var n=JSON.parse(t);lunr.tokenizer.separator=/[\s/]+/,function(t,n){var r,i=document.getElementById("post-search-input"),a=document.getElementById("post-search-results"),s=0;function c(){document.documentElement.classList.add("search-active"),i.setAttribute("aria-expanded","true")}function l(){document.documentElement.classList.remove("search-active"),i.setAttribute("aria-expanded","false")}function d(){s++;var e=i.value;if(""===e?l():c(),e!==r&&(r=e,a.innerHTML="",""!==e)){var d=t.query(function(t){var n=lunr.tokenizer(e);t.term(n,{boost:10}),t.term(n,{wildcard:lunr.Query.wildcard.TRAILING})});if(0==d.length&&e.length>2){var o=lunr.tokenizer(e).filter(function(e,t){return e.str.length<20});o.length>0&&(d=t.query(function(t){t.term(o,{editDistance:Math.round(Math.sqrt(e.length/2-1))})}))}if(0==d.length){var u=document.createElement("div");u.classList.add("search-no-result"),u.innerText="No results found",a.appendChild(u)}else{var h=document.createElement("ul");h.classList.add("search-results-list"),a.appendChild(h),v(h,d,0,10,100,s)}}function v(e,t,n,r,i,a){if(a==s){for(var c=n;c<n+r;c++){if(c==t.length)return;p(e,t[c])}setTimeout(function(){v(e,t,n+r,r,i,a)},i)}}function p(e,t){var r=n[t.ref],i=document.createElement("li");i.classList.add("search-results-list-item"),e.appendChild(i);var a=document.createElement("a");a.classList.add("search-result"),a.setAttribute("href",r.url),i.appendChild(a);var s=document.createElement("div");s.classList.add("search-result-title"),a.appendChild(s);var c=document.createElement("div");c.classList.add("search-result-doc-title"),c.innerHTML=r.doc,s.appendChild(c);var l=c;if(r.doc!=r.title){resultDoc.classList.add("search-result-doc-parent");var d=document.createElement("div");d.classList.add("search-result-section"),d.innerHTML=r.title,s.appendChild(d),l=d}var o=t.matchData.metadata,u=[],h=[];for(var v in o){var p=o[v];if(p.title){var m=p.title.position;for(var g in m)u.push(m[g])}if(p.content){m=p.content.position;for(var g in m){var E=(M=m[g])[0],w=M[0]+M[1],L=!0,y=!0;for(g=0;g<3;g++){var S=r.content.lastIndexOf(" ",E-2);if((b=r.content.lastIndexOf(". ",E-2))>=0&&b>S){E=b+1,L=!1;break}if(S<0){E=0,L=!1;break}E=S+1}for(g=0;g<3;g++){var b;S=r.content.indexOf(" ",w+1);if((b=r.content.indexOf(". ",w+1))>=0&&b<S){w=b,y=!1;break}if(S<0){w=r.content.length,y=!1;break}w=S}h.push({highlight:M,previewStart:E,previewEnd:w,ellipsesBefore:L,ellipsesAfter:y})}}}if(u.length>0&&(u.sort(function(e,t){return e[0]-t[0]}),l.innerHTML="",f(l,r.title,0,r.title.length,u)),h.length>0){h.sort(function(e,t){return e.highlight[0]-t.highlight[0]});var C=h[0],k={highlight:[C.highlight],previewStart:C.previewStart,previewEnd:C.previewEnd,ellipsesBefore:C.ellipsesBefore,ellipsesAfter:C.ellipsesAfter},T=[k];for(v=1;v<h.length;v++)C=h[v],k.previewEnd<C.previewStart?(k={highlight:[C.highlight],previewStart:C.previewStart,previewEnd:C.previewEnd,ellipsesBefore:C.ellipsesBefore,ellipsesAfter:C.ellipsesAfter},T.push(k)):(k.highlight.push(C.highlight),k.previewEnd=C.previewEnd,k.ellipsesAfter=C.ellipsesAfter);var x=document.createElement("div");x.classList.add("search-result-previews"),a.appendChild(x);var A=r.content;for(v=0;v<Math.min(T.length,2);v++){var M=T[v],q=document.createElement("div");q.classList.add("search-result-preview"),x.appendChild(q),M.ellipsesBefore&&q.appendChild(document.createTextNode("... ")),f(q,A,M.previewStart,M.previewEnd,M.highlight),M.ellipsesAfter&&q.appendChild(document.createTextNode(" ..."))}}}function f(e,t,n,r,i){var a=n;for(var s in i){var c,l=i[s];(c=document.createElement("span")).innerHTML=t.substring(a,l[0]),e.appendChild(c),a=l[0]+l[1];var d=document.createElement("span");d.classList.add("search-result-highlight"),d.innerHTML=t.substring(l[0],a),e.appendChild(d)}(c=document.createElement("span")).innerHTML=t.substring(a,r),e.appendChild(c)}}e.addEvent(i,"focus",function(){setTimeout(d,0)});var o=e.debounce(d,300);e.addEvent(i,"keyup",function(e){switch(e.keyCode){case 27:let t=document.getElementById("post-search-input");t.value="",t.blur(),l();break;case 38:case 40:case 13:return void e.preventDefault()}o()}),e.addEvent(i,"keydown",function(e){switch(e.keyCode){case 38:if(e.preventDefault(),(r=document.querySelector(".search-result.active"))&&(r.classList.remove("active"),r.parentElement.previousSibling)){var t=r.parentElement.previousSibling.querySelector(".search-result");t.classList.add("active"),t.scrollIntoView(!1)}return;case 40:if(e.preventDefault(),r=document.querySelector(".search-result.active")){if(r.parentElement.nextSibling){var n=r.parentElement.nextSibling.querySelector(".search-result");r.classList.remove("active"),n.classList.add("active"),n.scrollIntoView(!1)}}else(n=document.querySelector(".search-result"))&&n.classList.add("active");return;case 13:var r;if(e.preventDefault(),r=document.querySelector(".search-result.active"))r.click();else{var i=document.querySelector(".search-result");i&&i.click()}return}}),e.addEvent(document,"click",function(e){e.target!=i&&l()})}(lunr(function(){for(var e in this.ref("id"),this.field("title",{boost:500}),this.field("content",{boost:1}),this.field("url"),this.metadataWhitelist=["position"],n)this.add({id:e,title:n[e].title,content:n[e].content,url:n[e].url})}),n)}).catch(function(e){console.warn("Error processing the search-data for lunrjs",e)})}e.onReady(function(){document.onkeyup=function(e){var t=window.event||e;let n=document.getElementById("search-input"),r=t.keyCode||t.which;e.shiftKey&&83==r&&n.focus()},t()})}(window.sj=window.sj||{});