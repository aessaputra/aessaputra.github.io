!function (e) { "use strict"; e.addEvent = function (e, t, n) { e.attachEvent ? e.attachEvent("on" + t, n) : e.addEventListener(t, n) }, e.removeEvent = function (e, t, n) { e.detachEvent ? e.detachEvent("on" + t, n) : e.removeEventListener(t, n) }, e.onReady = function (e) { "loading" != document.readyState ? e() : document.addEventListener ? document.addEventListener("DOMContentLoaded", e) : document.attachEvent("onreadystatechange", function () { "complete" == document.readyState && e() }) }, e.debounce = function (e, t) { var n; return function r() { var i = this, a = arguments, s = function () { clearTimeout(n), e.apply(i, a) }; clearTimeout(n), n = setTimeout(s, t) } }; var t = !1; async function n(e) { return (await fetch(e)).text() } function r() { n("/UnifiedSearchData.json").then(function (t) { var n = JSON.parse(t); lunr.tokenizer.separator = /[\s/]+/, function t(n, r) { var i, n = n, r = r, a = document.getElementById("unified-search-input"), s = document.getElementById("unified-search-results"), l = 0; function c() { document.documentElement.classList.remove("search-active"), a.setAttribute("aria-expanded", "false") } function d() { l++; var e = a.value; if ("" === e ? c() : (document.documentElement.classList.add("search-active"), a.setAttribute("aria-expanded", "true")), e !== i) { if (i = e, s.innerHTML = "", "" !== e) { var t = n.query(function (t) { var n = lunr.tokenizer(e); t.term(n, { boost: 10 }), t.term(n, { wildcard: lunr.Query.wildcard.TRAILING }) }); if (0 == t.length && e.length > 2) { var d = lunr.tokenizer(e).filter(function (e, t) { return e.str.length < 20 }); d.length > 0 && (t = n.query(function (t) { t.term(d, { editDistance: Math.round(Math.sqrt(e.length / 2 - 1)) }) })) } if (0 == t.length) { var o = document.createElement("div"); o.classList.add("search-no-result"), o.innerText = "No results found", s.appendChild(o) } else { var u = document.createElement("ul"); u.classList.add("search-results-list"), s.appendChild(u), function e(t, n, r, i, a, s) { if (s == l) { for (var c = r; c < r + i; c++) { if (c == n.length) return; h(t, n[c]) } setTimeout(function () { e(t, n, r + i, i, a, s) }, a) } }(u, t, 0, 10, 100, l) } } } function h(e, t) { var n = r.find(function (e) { return e.id === t.ref }); if (n) { var i = document.createElement("li"); i.classList.add("search-results-list-item"), e.appendChild(i); var a = document.createElement("a"); a.classList.add("search-result"), a.setAttribute("href", n.url), i.appendChild(a); var s = document.createElement("div"); s.classList.add("search-result-title"), a.appendChild(s); var l = document.createElement("div"); l.classList.add("search-result-doc-title"), l.innerHTML = n.doc, s.appendChild(l); var c = l, d = document.createElement("span"); if (d.classList.add("search-result-type-badge"), d.classList.add("type-" + n.type), d.innerText = n.typeLabel, l.appendChild(d), n.doc != n.title) { l.classList.add("search-result-doc-parent"); var o = document.createElement("div"); o.classList.add("search-result-section"), o.innerHTML = n.title, s.appendChild(o), c = o } var u = t.matchData.metadata, h = [], f = []; for (var p in u) { var g = u[p]; if (g.title) { var E = g.title.position; for (var $ in E) h.push(E[$]) } if (g.content) { var E = g.content.position; for (var $ in E) { for (var m = E[$], y = m[0], L = m[0] + m[1], w = !0, b = !0, $ = 0; $ < 3; $++) { var _ = n.content.lastIndexOf(" ", y - 2), S = n.content.lastIndexOf(". ", y - 2); if (S >= 0 && S > _) { y = S + 1, w = !1; break } if (_ < 0) { y = 0, w = !1; break } y = _ + 1 } for (var $ = 0; $ < 3; $++) { var _ = n.content.indexOf(" ", L + 1), S = n.content.indexOf(". ", L + 1); if (S >= 0 && S < _) { L = S, b = !1; break } if (_ < 0) { L = n.content.length, b = !1; break } L = _ } f.push({ highlight: m, previewStart: y, previewEnd: L, ellipsesBefore: w, ellipsesAfter: b }) } } } if (h.length > 0 && (h.sort(function (e, t) { return e[0] - t[0] }), c.innerHTML = "", v(c, n.title, 0, n.title.length, h), c.appendChild(d)), f.length > 0) { f.sort(function (e, t) { return e.highlight[0] - t.highlight[0] }); for (var C = f[0], k = { highlight: [C.highlight], previewStart: C.previewStart, previewEnd: C.previewEnd, ellipsesBefore: C.ellipsesBefore, ellipsesAfter: C.ellipsesAfter }, x = [k], p = 1; p < f.length; p++)C = f[p], k.previewEnd < C.previewStart ? (k = { highlight: [C.highlight], previewStart: C.previewStart, previewEnd: C.previewEnd, ellipsesBefore: C.ellipsesBefore, ellipsesAfter: C.ellipsesAfter }, x.push(k)) : (k.highlight.push(C.highlight), k.previewEnd = C.previewEnd, k.ellipsesAfter = C.ellipsesAfter); var A = document.createElement("div"); A.classList.add("search-result-previews"), a.appendChild(A); for (var T = n.content, p = 0; p < Math.min(x.length, 2); p++) { var m = x[p], B = document.createElement("div"); B.classList.add("search-result-preview"), A.appendChild(B), m.ellipsesBefore && B.appendChild(document.createTextNode("... ")), v(B, T, m.previewStart, m.previewEnd, m.highlight), m.ellipsesAfter && B.appendChild(document.createTextNode(" ...")) } } } } function v(e, t, n, r, i) { var a = n; for (var s in i) { var l = i[s], c = document.createElement("span"); c.innerHTML = t.substring(a, l[0]), e.appendChild(c), a = l[0] + l[1]; var d = document.createElement("span"); d.classList.add("search-result-highlight"), d.innerHTML = t.substring(l[0], a), e.appendChild(d) } var c = document.createElement("span"); c.innerHTML = t.substring(a, r), e.appendChild(c) } } e.addEvent(a, "focus", function () { setTimeout(d, 0) }); var o = e.debounce(d, 300); e.addEvent(a, "keyup", function (e) { switch (e.keyCode) { case 27: let t = document.getElementById("unified-search-input"); t.value = "", t.blur(), c(); break; case 38: case 40: case 13: e.preventDefault(); return }o() }), e.addEvent(a, "keydown", function (e) { switch (e.keyCode) { case 38: e.preventDefault(); var t = document.querySelector(".search-result.active"); if (t && (t.classList.remove("active"), t.parentElement.previousSibling)) { var n = t.parentElement.previousSibling.querySelector(".search-result"); n.classList.add("active"), n.scrollIntoView(!1) } return; case 40: e.preventDefault(); var t = document.querySelector(".search-result.active"); if (t) { if (t.parentElement.nextSibling) { var r = t.parentElement.nextSibling.querySelector(".search-result"); t.classList.remove("active"), r.classList.add("active"), r.scrollIntoView(!1) } } else { var r = document.querySelector(".search-result"); r && r.classList.add("active") } return; case 13: e.preventDefault(); var t = document.querySelector(".search-result.active"); if (t) t.click(); else { var i = document.querySelector(".search-result"); i && i.click() } return } }), e.addEvent(document, "click", function (e) { e.target != a && c() }) }(lunr(function () { for (var e in this.ref("id"), this.field("title", { boost: 500 }), this.field("content", { boost: 1 }), this.field("url"), this.field("type", { boost: 2 }), this.metadataWhitelist = ["position"], n) this.add({ id: n[e].id, title: n[e].title, content: n[e].content, url: n[e].url, type: n[e].type }) }), n) }).catch(function (e) { console.warn("Error processing the unified search-data for lunrjs", e) }) } e.onReady(function () { document.onkeyup = function (e) { var t = window.event || e; let n = document.getElementById("unified-search-input"), r = t.keyCode || t.which; e.shiftKey && 83 == r && n.focus() }; var e = document.getElementById("unified-search-input"); e && (e.addEventListener("focus", function () { t || (t = !0, r()) }, { once: !1 }), e.addEventListener("input", function () { t || (t = !0, r()) }, { once: !0 })) }) }(window.sj = window.sj || {});